-- These are sellers that have made at least one "Flex" shipment in a time period

-- Shipment types  -- filtered by cust_ids
SELECT
sit_site_id,
SHP_SENDER_ID,
SHP_PICKING_TYPE_ID

from meli-bi-data.WHOWNER.BT_SHP_SHIPMENTS

Where sit_site_id in ('MLA','MLB','MLM','MLC','MLU','MCO')
and SHP_DATE_SHIPPED_ID BETWEEN date '2022-03-01' and date '2022-05-15'
--and SHP_PICKING_TYPE_ID = 'self_service'
and SHP_SENDER_ID IN (232695503,65140955,248979588,253665187,337662514,109924016,454694309,251017562,245939349,57691993,80368614,234976069,180891834,287455917)
group by 1,2,3


-- Flex
SELECT
sit_site_id,
SHP_SENDER_ID,
SHP_PICKING_TYPE_ID

from meli-bi-data.WHOWNER.BT_SHP_SHIPMENTS

Where sit_site_id in ('MLA','MLB','MLM','MLC','MLU','MCO')
and SHP_DATE_SHIPPED_ID BETWEEN date '2022-03-01' and date '2022-05-15'
and SHP_PICKING_TYPE_ID = 'self_service'
and SHP_SENDER_ID IN (541718569,542877871)
group by 1,2,3


-- Full
SELECT
sit_site_id,
SHP_SENDER_ID,
SHP_PICKING_TYPE_ID

from meli-bi-data.WHOWNER.BT_SHP_SHIPMENTS

Where sit_site_id in ('MLA','MLB','MLM','MLC','MLU','MCO')
and SHP_DATE_SHIPPED_ID BETWEEN date '2022-03-01' and date '2022-05-15'
and SHP_PICKING_TYPE_ID = 'fulfillment'
and SHP_SENDER_ID IN (541718569,542877871)
group by 1,2,3

-- Colecta
SELECT
sit_site_id,
SHP_SENDER_ID,
SHP_PICKING_TYPE_ID

from meli-bi-data.WHOWNER.BT_SHP_SHIPMENTS

Where sit_site_id in ('MLA','MLB','MLM','MLC','MLU','MCO')
and SHP_DATE_SHIPPED_ID BETWEEN date '2022-03-01' and date '2022-05-15'
and SHP_PICKING_TYPE_ID = 'cross_docking'
and SHP_SENDER_ID IN (541718569,542877871)
group by 1,2,3


--Other queries

select distinct
SIT_SITE_ID as site,
CUS_CUST_ID_SEL as cust_id,
ITE_ITEM_SHIPPING_LOGISTIC_TYPE as logistic_type
from `meli-bi-data.WHOWNER.LK_ITE_ITEMS`
where ITE_ITEM_SHIPPING_LOGISTIC_TYPE = 'self_service'
AND ITE_ITEM_STATUS = 'active'
AND ITE_ITEM_AUCTION_START_DATETIME BETWEEN '2022-03-01' and '2022-03-31' 
--AND SIT_SITE_ID = 'MLA'
--AND CUS_CUST_ID_SEL IN (180891834,80368614,22658616,270240696,117454296,106748418,226807738)
GROUP BY 1,2,3;

select distinct
SIT_SITE_ID as site,
CUS_CUST_ID_SEL as cust_id,
ITE_ITEM_SHIPPING_LOGISTIC_TYPE as logistic_type
from `meli-bi-data.WHOWNER.LK_ITE_ITEMS`
where  ITE_ITEM_STATUS = 'active'
--AND SIT_SITE_ID = 'MLA'
AND ITE_ITEM_AUCTION_START_DATETIME BETWEEN '2021-01-01' and '2022-03-31' 
AND CUS_CUST_ID_SEL IN (53354860,287455917,430328184,180891834,234976069,80368614,57691993,245939349,251017562)
GROUP BY 1,2,3
ORDER BY 1,2,3;


select distinct
SIT_SITE_ID as site,
CUS_CUST_ID_SEL as cust_id,
ITE_ITEM_SHIPPING_LOGISTIC_TYPE as logistic_type
from `meli-bi-data.WHOWNER.LK_ITE_ITEMS`
where ITE_ITEM_SHIPPING_LOGISTIC_TYPE = 'fulfillment'
AND ITE_ITEM_STATUS = 'active'
AND ITE_ITEM_AUCTION_START_DATETIME BETWEEN '2022-03-01' and '2022-03-31' 
--AND SIT_SITE_ID = 'MLA'
--AND CUS_CUST_ID_SEL IN (180891834,80368614,22658616,270240696,117454296,106748418,226807738)
GROUP BY 1,2,3;
